<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ³å¸Œæœ›è€…ç™»éŒ²ãƒšãƒ¼ã‚¸</title>
    <script type="text/javascript" src="https://cdn.emailjs.com/dist/email.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; }
        form { max-width: 500px; margin: auto; padding: 20px; border: 1px solid #ccc; border-radius: 10px; }
        label { display: block; margin-top: 10px; }
        select, textarea, input { width: 100%; padding: 8px; margin-top: 5px; }
        .error { color: red; font-size: 0.9em; }
        .buttons { margin-top: 15px; display: flex; flex-direction: column; align-items: center; }
        .dob-container { display: flex; gap: 10px; align-items: center; }
        .dob-container select { width: 32%; }
        .privacy-policy { font-size: 0.9em; text-align: center; margin-bottom: 10px; }
        #drop-area { border: 2px dashed #ccc; padding: 20px; text-align: center; cursor: pointer; margin-top: 10px; }
    </style>
</head>
<body>
    <h2 style="text-align: center;">ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ³å¸Œæœ›è€…ç™»éŒ²ãƒšãƒ¼ã‚¸</h2>
    <form id="registrationForm">
        <label>ãƒ»åå‰ï¼ˆ<span style="color: red;">å¿…é ˆ</span>ï¼‰<input type="text" id="name" required></label>
        <span class="error" id="error-name"></span>
        
        <label>ãƒ»ãƒ•ãƒªã‚¬ãƒŠï¼ˆ<span style="color: red;">å¿…é ˆ</span>ï¼‰<input type="text" id="furigana" required></label>
        <span class="error" id="error-furigana"></span>

       <label>ãƒ»ç”Ÿå¹´æœˆæ—¥ï¼ˆ<span style="color: red;">å¿…é ˆ</span>ï¼‰</label>
        <div class="dob-container">
            <select id="dob-year" required>
                <option value="">YYYY</option>
                <script>
                    for(let year = 1970; year <= 2020; year++) {
                        document.write(`<option value="${year}">${year}</option>`);
                    }
                </script>
            </select>
            /
            <select id="dob-month" required>
                <option value="">MM</option>
                <script>
                    for(let month = 1; month <= 12; month++) {
                        document.write(`<option value="${month}">${month}</option>`);
                    }
                </script>
            </select>
            /
            <select id="dob-day" required>
                <option value="">DD</option>
                <script>
                    for(let day = 1; day <= 31; day++) {
                        document.write(`<option value="${day}">${day}</option>`);
                    }
                </script>
            </select>
        </div>
        <span class="error" id="error-dob-year"></span>
        <span class="error" id="error-dob-month"></span>
        <span class="error" id="error-dob-day"></span>
        
        <label>ãƒ»ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ï¼ˆ<span style="color: red;">å¿…é ˆ</span>ï¼‰<input type="email" id="email" required></label>
        <span class="error" id="error-email"></span>
        
        <label>ãƒ»é›»è©±ç•ªå·ï¼ˆä»»æ„ï¼‰<input type="tel" id="phone"></label>
        
        <label>ãƒ»å¸Œæœ›è·ç¨®ï¼ˆ<span style="color: red;">å¿…é ˆ</span>ï¼‰
            <select id="job" required>
                <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                <option value="éŸ³éŸ¿">éŸ³éŸ¿</option>
                <option value="ç…§æ˜">ç…§æ˜</option>
                <option value="æ˜ åƒ">æ˜ åƒ</option>
                <option value="èˆå°">èˆå°</option>
                <option value="é‹å–¶">é‹å–¶</option>
            </select>
        </label>
        <span class="error" id="error-job"></span>
        
        <label>ãƒ»å¸Œæœ›å‹¤å‹™æ—¥ç¨‹ï¼ˆ<span style="color: red;">å¿…é ˆ</span>ï¼‰<textarea id="schedule" required></textarea></label>
        <span class="error" id="error-schedule"></span>
        
        <label>ãƒ»çµŒé¨“ã®æœ‰ç„¡ï¼ˆ<span style="color: red;">å¿…é ˆ</span>ï¼‰
            <select id="experience" required>
    <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
    <option value="çµŒé¨“ãªã—">çµŒé¨“ãªã—</option>
    <option value="çµŒé¨“ã‚ã‚Šã€œï¼‘å¹´æœªæº€">çµŒé¨“ã‚ã‚Šã€œï¼‘å¹´æœªæº€</option>
    <option value="çµŒé¨“ã‚ã‚Šã€œï¼“å¹´æœªæº€">çµŒé¨“ã‚ã‚Šã€œï¼“å¹´æœªæº€</option>
    <option value="çµŒé¨“ã‚ã‚Šã€œï¼•å¹´æœªæº€">çµŒé¨“ã‚ã‚Šã€œï¼•å¹´æœªæº€</option>
    <option value="çµŒé¨“ã‚ã‚Šã€œï¼•å¹´ä»¥ä¸Š">çµŒé¨“ã‚ã‚Šã€œï¼•å¹´ä»¥ä¸Š</option>
</select>
        </label>
        <span class="error" id="error-experience"></span>
        
        <label>ãƒ»ã‚¹ã‚­ãƒ«&å–å¾—è³‡æ ¼&è‡ªå·±PRï¼ˆ<span style="color: red;">å¿…é ˆ</span>ï¼‰<textarea id="skills" required></textarea></label>
        <span class="error" id="error-skills"></span>
        
        <label>ãƒ»å¿—æœ›å‹•æ©Ÿï¼ˆ<span style="color: red;">å¿…é ˆ</span>ï¼‰<textarea id="motivation" required></textarea></label>
        <span class="error" id="error-motivation"></span>
        
        <label>ãƒ»å†™çœŸã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼ˆ<span style="color: red;">å¿…é ˆ</span>ï¼‰</label>
        <div id="drop-area">ã“ã“ã«ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ã™ã‚‹ã‹ã€ã‚¯ãƒªãƒƒã‚¯ã—ã¦é¸æŠ</div>
        <input type="file" id="photo" accept="image/*" required style="display: none;">
        <span class="error" id="error-photo"></span>
        
         <p style="font-size: 0.9em; text-align: center;">
    ğŸ“œ <strong>å€‹äººæƒ…å ±ã®å–ã‚Šæ‰±ã„ã«ã¤ã„ã¦</strong><br>
    ã”ç™»éŒ²ã„ãŸã ã„ãŸå€‹äººæƒ…å ±ã¯ã€å½“ç¤¾ã®æ¡ç”¨æ´»å‹•ãŠã‚ˆã³é–¢é€£ã™ã‚‹æ¥­å‹™ã®ãŸã‚ã«ã®ã¿åˆ©ç”¨ã—ã€
    ç¬¬ä¸‰è€…ã¸æä¾›ãƒ»é–‹ç¤ºã™ã‚‹ã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚<br>
    ãªãŠã€å½“ç¤¾ã®å€‹äººæƒ…å ±ä¿è­·æ–¹é‡ã«åŸºã¥ãã€é©åˆ‡ã«ç®¡ç†ã„ãŸã—ã¾ã™ã€‚<br>
    è©³ç´°ã«ã¤ã„ã¦ã¯ã€<a href="privacy_policy" target="_blank">ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼</a>ã‚’ã”ç¢ºèªãã ã•ã„ã€‚
</p>

<div class="buttons">
            <button type="button" onclick="validateForm()">ç™»éŒ²ç¢ºèª</button>
        </div>
    </form>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            const dropArea = document.getElementById("drop-area");
            const fileInput = document.getElementById("photo");
            
            dropArea.addEventListener("click", function() {
                fileInput.click();
            });
            
            dropArea.addEventListener("dragover", function(e) {
                e.preventDefault();
                this.style.borderColor = "#000";
            });
            
            dropArea.addEventListener("dragleave", function(e) {
                e.preventDefault();
                this.style.borderColor = "#ccc";
            });
            
            dropArea.addEventListener("drop", function(e) {
                e.preventDefault();
                this.style.borderColor = "#ccc";
                const file = e.dataTransfer.files[0];
                fileInput.files = e.dataTransfer.files;
                if (file) {
                    this.textContent = file.name;
                }
            });
            
            fileInput.addEventListener("change", function() {
                if (this.files.length > 0) {
                    dropArea.textContent = this.files[0].name;
                }
            });
        });

        function validateForm() {
            let isValid = true;
            document.querySelectorAll(".error").forEach(el => el.textContent = "");

            const fields = ["name", "furigana", "email", "job", "schedule", "experience", "skills", "motivation"];
            let formData = {};

            fields.forEach(id => {
                let input = document.getElementById(id);
                if (!input.value.trim()) {
                    document.getElementById("error-" + id).textContent = "æœªå…¥åŠ›ã§ã™";
                    isValid = false;
                } else {
                    formData[id] = input.value;
                }
            });

            // ç”Ÿå¹´æœˆæ—¥ã®å–å¾—
            const dobYear = document.getElementById("dob-year").value;
            const dobMonth = document.getElementById("dob-month").value;
            const dobDay = document.getElementById("dob-day").value;
            if (!dobYear || !dobMonth || !dobDay) {
                document.getElementById("error-dob-year").textContent = "æœªå…¥åŠ›ã§ã™";
                isValid = false;
            } else {
                formData.dob = `${dobYear}-${dobMonth}-${dobDay}`;
            }

            if (isValid) {
                // ç”»åƒã‚’Base64å½¢å¼ã§å–å¾—
                let fileInput = document.getElementById("photo");
                if (fileInput.files.length > 0) {
                    let reader = new FileReader();
                    reader.onloadend = function () {
                        formData.photo = reader.result.split(',')[1]; // Base64ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—

                        // EmailJSã§ç”»åƒã‚’æ·»ä»˜ã—ã¦é€ä¿¡
                        emailjs.send("YOUR_SERVICE_ID", "YOUR_TEMPLATE_ID", {
                            name: formData.name,
                            email: formData.email,
                            photo: formData.photo // ç”»åƒãƒ‡ãƒ¼ã‚¿ã‚’æ·»ä»˜
                        }).then(function(response) {
                            console.log("ãƒ¡ãƒ¼ãƒ«é€ä¿¡æˆåŠŸ", response.status, response.text);
                        }, function(error) {
                            console.log("ãƒ¡ãƒ¼ãƒ«é€ä¿¡å¤±æ•—", error);
                        });

                        // Googleã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã¸ãƒ‡ãƒ¼ã‚¿é€ä¿¡
                        fetch("https://script.google.com/macros/s/YOUR_DEPLOYED_WEB_APP_URL/exec", {
                            method: "POST",
                            headers: { "Content-Type": "application/json" },
                            body: JSON.stringify(formData)
                        }).then(response => response.text())
                        .then(data => console.log("Googleã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã«ç™»éŒ²æˆåŠŸ: ", data))
                        .catch(error => console.log("Googleã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆç™»éŒ²å¤±æ•—: ", error));

                        window.location.href = "confirmation.html";
                    };
                    reader.readAsDataURL(fileInput.files[0]);
                }
            }
        }

        function doPost(e) {
          var sheet = SpreadsheetApp.openById("YOUR_SPREADSHEET_ID").getSheetByName("ã‚·ãƒ¼ãƒˆ1");
          var data = JSON.parse(e.postData.contents);

          var fileBlob = Utilities.newBlob(Utilities.base64Decode(data.photo), "image/png", "upload.png");
          var folder = DriveApp.getFolderById("YOUR_DRIVE_FOLDER_ID"); // ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å…ˆã®Googleãƒ‰ãƒ©ã‚¤ãƒ–ãƒ•ã‚©ãƒ«ãƒ€ID
          var file = folder.createFile(fileBlob);
          var fileUrl = file.getUrl(); // Googleãƒ‰ãƒ©ã‚¤ãƒ–ã®ç”»åƒURLå–å¾—

          sheet.appendRow([data.name, data.furigana, data.dob, data.email, data.phone, data.job, data.schedule, data.experience, data.skills, data.motivation, fileUrl]);

          return ContentService.createTextOutput("ç™»éŒ²å®Œäº†").setMimeType(ContentService.MimeType.TEXT);
        }
    </script>
</body>
</html>
